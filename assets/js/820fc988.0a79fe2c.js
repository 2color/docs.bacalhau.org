"use strict";(self.webpackChunkbacalhau_docs=self.webpackChunkbacalhau_docs||[]).push([[6524],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=u(n),h=r,m=d["".concat(s,".").concat(h)]||d[h]||c[h]||o;return n?a.createElement(m,i(i({ref:t},p),{},{components:n})):a.createElement(m,i({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1774:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var a=n(7462),r=(n(7294),n(3905));const o={sidebar_label:"Overview",sidebar_position:100},i="Join as Compute Provider",l={unversionedId:"running-node/index",id:"running-node/index",title:"Join as Compute Provider",description:"Bacalhau is a peer-to-peer network of compute providers that will run jobs submitted by users. A Compute Provider (CP) is anyone who is running a Bacalhau compute node participating in the Bacalhau compute network, regardless of whether they are hosting any Filecoin data.",source:"@site/docs/running-node/index.md",sourceDirName:"running-node",slug:"/running-node/",permalink:"/running-node/",draft:!1,editUrl:"https://github.com/bacalhau-project/docs.bacalhau.org/blob/main/docs/running-node/index.md",tags:[],version:"current",sidebarPosition:100,frontMatter:{sidebar_label:"Overview",sidebar_position:100},sidebar:"documentationSidebar",previous:{title:"GPU Workloads",permalink:"/getting-started/gpu"},next:{title:"Networking",permalink:"/running-node/networking"}},s={},u=[{value:"Quick start (Ubuntu 22.04)",id:"quick-start-ubuntu-2204",level:2},{value:"Install the bacalhau binary",id:"install-the-bacalhau-binary",level:3},{value:"Install docker",id:"install-docker",level:3},{value:"Ensure IPFS is running",id:"ensure-ipfs-is-running",level:3},{value:"Configure firewall",id:"configure-firewall",level:3},{value:"Run bacalhau",id:"run-bacalhau",level:3}],p={toc:u};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"join-as-compute-provider"},"Join as Compute Provider"),(0,r.kt)("p",null,"Bacalhau is a peer-to-peer network of compute providers that will run jobs submitted by users. A Compute Provider (CP) is anyone who is running a Bacalhau compute node participating in the Bacalhau compute network, regardless of whether they are hosting any Filecoin data."),(0,r.kt)("p",null,"This section will show you how to configure and run a bacalhau node and start accepting and running jobs."),(0,r.kt)("p",null,"To bootstrap your node and join the network as a CP you can leap right into the ",(0,r.kt)("a",{parentName:"p",href:"#quick-start-ubuntu-2204"},"Ubuntu 22.04 quick start")," below, or find for more setup details in these guides:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"networking"},"Networking")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"storage-providers"},"Storage Providers")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"job-selection"},"Job Selection Policy")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"resource-limits"},"Resource Limits")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"gpu"},"GPU Support")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"windows-support"},"Windows Support"))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"If you run on a different system than Ubuntu, drop us a message on ",(0,r.kt)("a",{parentName:"p",href:"https://filecoinproject.slack.com/archives/C02RLM3JHUY"},"Slack"),"!\nWe'll add instructions for your favourite OS.")),(0,r.kt)("h2",{id:"quick-start-ubuntu-2204"},"Quick start (Ubuntu 22.04)"),(0,r.kt)("p",null,"Tested on: Ubuntu, 22.04 LTS (x86/64)"),(0,r.kt)("h3",{id:"install-the-bacalhau-binary"},"Install the bacalhau binary"),(0,r.kt)("p",null,"First, you should ",(0,r.kt)("a",{parentName:"p",href:"/getting-started/installation#prerequisite-install-bacalhau-client"},"install the bacalhau binary")," to run ",(0,r.kt)("inlineCode",{parentName:"p"},"bacalhau serve"),". "),(0,r.kt)("h3",{id:"install-docker"},"Install docker"),(0,r.kt)("p",null,"To run docker based workloads, you should have docker installed and running."),(0,r.kt)("p",null,"If you already have it installed and want to configure the connection to Docker with the following environment variables:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"DOCKER_HOST")," to set the url to the docker server."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"DOCKER_API_VERSION")," to set the version of the API to reach, leave empty for latest."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"DOCKER_CERT_PATH")," to load the TLS certificates from."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"DOCKER_TLS_VERIFY")," to enable or disable TLS verification, off by default.")),(0,r.kt)("p",null,"If you do not have Docker on your system, you can follow the official ",(0,r.kt)("a",{parentName:"p",href:"https://docs.docker.com/engine/install/"},"docker installation instructions")," or just use the snippet below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'# install dependencies\nsudo apt-get update\nsudo apt-get install \\\n    ca-certificates \\\n    curl \\\n    gnupg \\\n    lsb-release\n\n# add package repo and key\nsudo mkdir -p /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\necho \\\n  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \\\n  $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\n\n# install docker\nsudo apt-get update\nsudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin\n')),(0,r.kt)("h3",{id:"ensure-ipfs-is-running"},"Ensure IPFS is running"),(0,r.kt)("p",null,"We will need to connect our bacalhau node to an IPFS server so we can run jobs that consume CIDs as inputs."),(0,r.kt)("p",null,"You can either install IPFS and run it locally or you can connect to a remote IPFS server."),(0,r.kt)("p",null,"In both cases - we should have an ",(0,r.kt)("a",{parentName:"p",href:"https://richardschneider.github.io/net-ipfs-core/articles/multiaddress.html"},"IPFS multiaddress")," for our IPFS server that should look something like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"export IPFS_CONNECT=/ip4/10.1.10.10/tcp/80/p2p/QmVcSqVEsvm5RR9mBLjwpb2XjFVn5bPdPL69mL8PH45pPC\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"The multiaddress above is just an example - you need to get the multiaddress of the IPFS server you want to connect to.")),(0,r.kt)("p",null,"To install a single IPFS node locally on Ubuntu you can follow the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.ipfs.tech/install/ipfs-desktop/#ubuntu"},"official instructions"),", or follow the steps below."),(0,r.kt)("p",null,"We advise to run the same IPFS version as the Bacalhau main network.\nPick that with the command below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"export IPFS_VERSION=$(wget -q -O - https://raw.githubusercontent.com/filecoin-project/bacalhau/main/ops/terraform/production.tfvars | grep --color=never ipfs_version | awk -F'\"' '{print $2}')\n")),(0,r.kt)("p",null,"Install:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'wget "https://dist.ipfs.tech/go-ipfs/${IPFS_VERSION}/go-ipfs_${IPFS_VERSION}_linux-amd64.tar.gz"\ntar -xvzf "go-ipfs_${IPFS_VERSION}_linux-amd64.tar.gz"\ncd go-ipfs\nsudo bash install.sh\nipfs --version\n')),(0,r.kt)("p",null,"Configure:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"sudo mkdir -p /data/ipfs\nexport IPFS_PATH=/data/ipfs\nsudo chown <user>:<group> ${IPFS_PATH}\nipfs init\n")),(0,r.kt)("p",null,"Now launch the IPFS daemon in a separate terminal (make sure to export the ",(0,r.kt)("inlineCode",{parentName:"p"},"IPFS_PATH")," environment variable there as well):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ipfs daemon\n")),(0,r.kt)("p",null,"If you want to run the IPFS daemon as a ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Systemd"},"systemd")," feel free to reuse ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/filecoin-project/bacalhau/blob/main/ops/terraform/remote_files/configs/ipfs-daemon.service"},"this service configuration file"),". "),(0,r.kt)("p",null,"Don't forget we need to fetch a ",(0,r.kt)("a",{parentName:"p",href:"https://richardschneider.github.io/net-ipfs-core/articles/multiaddress.html"},"IPFS multiaddress")," of our local IPFS node.\nThe following command prints out a number of addresses."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"ipfs id\nexport IPFS_CONNECT=/ip4/127.0.0.1/tcp/5001/p2p/12D3KooWDkArGGx55V3eg65qW8dxyPWX5ed7XWJCiqBBnABLRsw8\n")),(0,r.kt)("h3",{id:"configure-firewall"},"Configure firewall"),(0,r.kt)("p",null,"To ensure that our node can communicate with other nodes on the network - we need to make sure the ",(0,r.kt)("strong",{parentName:"p"},"1235")," port is open."),(0,r.kt)("p",null,"Firewall configuration is very specific to your network and we can't provide generic instructions for this step but if you need any help feel free to reach out on ",(0,r.kt)("a",{parentName:"p",href:"https://filecoinproject.slack.com/archives/C02RLM3JHUY"},"Slack!")),(0,r.kt)("h3",{id:"run-bacalhau"},"Run bacalhau"),(0,r.kt)("p",null,"Now we can run our bacalhau node:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"LOG_LEVEL=debug bacalhau serve \\\n  --ipfs-connect $IPFS_CONNECT\n")))}c.isMDXComponent=!0}}]);